<%= set_meta_description "Learn to play #{@song.title} with InstrumentChamp. The best way to learn to play music." %>
<%= set_page_title "Learn to play #{@song.title} with InstrumentChamp" %>


<%= content_for(:detail_header_thumb) do %>
	<%= image_tag @song.cover_url %>
<% end %>

<%= content_for(:detail_header_primary_info) do %>
	<h3>Song by <%= link_to @song.artist.title, @song.artist %></h3>
	<h2><%= @song.title %></h2>
	<p>
		Written by <b><%= @song.writer %></b> <br />
		Published by <b><%= @song.publisher %></b>
	</p>
	<br class="hidden-xs" />
	<%= link_to "Challenge", new_challenge_path(song_id: @song.id), class: "btn btn-primary" %>
	<%= link_to 'Practice', @song.play_url, class: "btn btn-default" %>
<% end %>

<%= content_for(:detail_header_secondary_info) do %>
	<div><%= render "available_instruments" %></div>
	<div class="hidden-xs"><br /><br /><br /><br /></div>
	<div><b>Difficulty:</b> <%= @song.display_difficulty %></div>
	<div><b>Players:</b> 100000</div>
<% end %>

<%= content_for(:detail_header_nav_left) do %>
	<ul>
		<li class="active"><a href="#overview_tab" data-toggle="tab">Overview</a></li>
	  <li><a href="#challenges_tab" data-toggle="tab">Challenges</a></li>
	  <li><a href="#leaderboards_tab" data-toggle="tab">Leaderboards</a></li>
	</ul>
<% end %>


<div class="tab-content">
	<div class="tab-pane active" id="overview_tab">
		<% unless @activity_feeds.empty? %>
		  <br />
		  <%= render @activity_feeds %>
		  <br />
		  <% unless @activity_feeds.last_page? %>
		    <div id="more_posts"></div>
		    <%= link_to 'View more', activities_artist_song_path(@song.artist, @song, page: 2), { remote: true, id: "show_more_posts_link" } %>
		  <% end %>
		<% end %>
	</div>
	<div class="tab-pane" id="challenges_tab">
		Challenges
	</div>
	<div class="tab-pane" id="leaderboards_tab">
		<% unless @scores.blank? %>
			<div class="col-lg-9">
				<%= render 'shared/header_page', title: 'Top Scores', sub_header: true %>

				<table width="100%" class="datagrid">
					<tr class="head">
						<td>User</td>
						<td>Points</td>
						<td>Instrument</td>
						<td></td>
					</tr>
					<% @scores.each do |score| %>
						<% if score.user and score.score > 0 %>
							<tr class="<%= cycle("odd", "even") %>">
								<td><%= link_to score.user.username, person_path(score.user), class: 'btn-secondary-color' %></td>
								<td><%= score.score %></td>
								<td><%= score.instrument.name %></td>
								<td align="right"><%= link_to 'Challenge', new_challenge_path(song_id: score.song.id, challenged_id: score.user.id), class: 'btn btn-primary btn-sm' %></td>
							</tr>
						<% end %>
					<% end %>
				</table>
			</div>
		<% else %>
			<p>No records</p>
		<% end %>
	</div>
</div>

<%= content_for(:detail_right_col) do %>
	<h2>Leaderboards</h2>
<% end %>

<!--
<br /><br />

<%= render 'shared/header_page', title: 'More songs', sub_header:true, view_more: 'View more', view_more_path: songs_path %>

<div class="thumbnail-grid row">
  <%= render @more_songs %>
</div>

<%= render 'shared/banner_ad' %>
-->