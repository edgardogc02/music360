<%= render 'shared/header_page', title: @artist.title %>

<div class="row">
	<div class="col-lg-3">
		<p>
			<% if @artist.imagename_url %>
				<% if @artist.imagename_url != @artist.imagename.default_url %>
					<%= image_tag(@artist.imagename_url, {alt: @artist.title, class: 'thumbnail'}) %>
				<% elsif @artist.public_image_url %>
					<%= image_tag(@artist.public_image_url.url, {alt: @artist.title, class: 'thumbnail'}) %>
				<% else %>
					<%= image_tag(@artist.imagename_url, {alt: @artist.title, class: 'thumbnail'}) %>
				<% end %>
			<% else %>
				<%= image_tag(@artist.public_image_url.url, {alt: @artist.title, class: 'thumbnail'}) %>
			<% end %>
		</p>
	</div>
	<div class="col-lg-9">		
		<ul class="nav nav-tabs">
			<li class="active"><a href="#info" data-toggle="tab">Info</a></li>
		  <li><a href="#songs" data-toggle="tab">Songs</a></li>
		  <li><a href="#challenges_tab" data-toggle="tab">Challenges</a></li>
		</ul>
		<br />
		<div class="tab-content">
			<div class="tab-pane active" id="info">
				<% if @artist.bio %>
					<p><%= truncate(@artist.bio.text, length: 1000, separator: ' ') { link_to "Read more", @artist.bio.url, {class: 'margin-left', target: '_blank'} } %></p>
				<% else %>
					<p>No info available</p>
				<% end %>
			</div>
		  <div class="tab-pane" id="songs">
		  	<% if !@songs.blank? %>
					<section>
						<%= render 'shared/header_page', title: 'Songs', sub_header: true, view_more: 'View more', view_more_path: songs_path %>
		
						<table width="100%" class="datagrid">
							<tr class="head">
								<td>Song</td>
								<td>Rating</td>
								<td></td>
							</tr>
							<% @songs.each do |song| %>
								<tr class="<%= cycle("odd", "even") %>">
									<td><%= link_to song.title, song_path(song), class: 'btn-secondary-color' %></td>
									<td><%= song.display_rating %></td>
									<td align="right">
										<%= link_to song.play_url, class: "btn btn-primary btn-sm" do %>
											<i class="glyphicon glyphicon-play"></i> Play
										<% end %>			
										<%= link_to "Challenge", new_challenge_path(song_id: song.id), class: "btn btn-primary btn-sm" %>
									</td>
								</tr>
							<% end %>
						</table>
						
					</section>
				<% else %>
					<p>No songs</p>
				<% end %>
		  </div>
		  <div class="tab-pane" id="challenges_tab">
		  	<% if !@challenges.blank? %>
			  	<%= render 'shared/header_page', title: 'Challenges', sub_header: true, view_more: 'View more', view_more_path: challenges_path %>
			
					<table width="100%" class="datagrid">
						<% @challenges.each do |challenge| %>
							<tr class="<%= cycle("odd", "even") %>">
								<td class="thumb"><%= image_tag challenge.cover_url, class: "avatar-xs" %></td>
								<td><%= link_to challenge.song.title, song_path(challenge.song) %>
					    	by <%= link_to challenge.song.artist.title, artist_path(challenge.song.artist)%></td>
								<td><%= challenge.display_results %></td>
							</tr>
						<% end %>
					</table>
				<% else %>
					<p>No challenges</p>
				<% end %>
		  </div>
		</div>
		
	</div>
</div>
